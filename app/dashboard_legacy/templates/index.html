{% extends "base.html" %}

{% block title %}Dashboard - EUFM Assistant{% endblock %}

{% block content %}
<!-- Critical Deadline Alert -->
<div class="row mb-4">
    <div class="col-12">
        <div class="alert alert-danger border-0 shadow-sm">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h4 class="alert-heading mb-2">
                        <i class="fas fa-exclamation-triangle"></i> CRITICAL DEADLINE ALERT
                    </h4>
                    <p class="mb-2">
                        <strong>Stage 1 Proposal Due: September 4, 2025</strong><br>
                        <small>HORIZON-CL6-2025-02-FARM2FORK-01-two-stage: Emerging and future risks to plant health</small>
                    </p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="display-6 text-danger">
                        <i class="fas fa-clock"></i> 3 DAYS
                    </div>
                    <small class="text-muted">Remaining</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col-md-3">
        <a href="{{ url_for('proposal') }}" class="card text-decoration-none">
            <div class="card-body text-center bg-primary text-white">
                <i class="fas fa-file-alt fa-2x mb-2"></i>
                <h6>Generate Proposal</h6>
                <small>Stage 1 - 10 pages</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('research') }}" class="card text-decoration-none">
            <div class="card-body text-center bg-success text-white">
                <i class="fas fa-search fa-2x mb-2"></i>
                <h6>Find Partners</h6>
                <small>Research & Discovery</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('strategy') }}" class="card text-decoration-none">
            <div class="card-body text-center bg-info text-white">
                <i class="fas fa-lightbulb fa-2x mb-2"></i>
                <h6>Strategy</h6>
                <small>Xylella Solution</small>
            </div>
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('documents') }}" class="card text-decoration-none">
            <div class="card-body text-center bg-warning text-white">
                <i class="fas fa-folder fa-2x mb-2"></i>
                <h6>Documents</h6>
                <small>Manage Files</small>
            </div>
        </a>
    </div>
</div>

<!-- Project Status Overview -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5><i class="fas fa-chart-pie"></i> Project Compliance</h5>
            </div>
            <div class="card-body text-center">
                <div class="compliance-score text-primary">{{ compliance_score }}%</div>
                <div class="progress mb-2">
                    <div class="progress-bar bg-primary" role="progressbar" 
                         style="width: {{ compliance_score }}%" 
                         aria-valuenow="{{ compliance_score }}" 
                         aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <small class="text-muted">Overall project health</small>
            </div>
        </div>
    </div>
    
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-dark text-white">
                <h5><i class="fas fa-tasks"></i> Critical Tasks Timeline</h5>
            </div>
            <div class="card-body">
                <div class="timeline">
                    <div class="timeline-item deadline-alert p-3 mb-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>PROP-T1.1</strong> - Complete Stage 1 proposal draft
                                <br><small class="text-muted">Owner: pm</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-danger">Due: Sep 2</span>
                                <br><small class="text-muted">1 day remaining</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item at-risk p-3 mb-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>PROP-T1.2</strong> - Final review and submission preparation
                                <br><small class="text-muted">Owner: pm</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-warning">Due: Sep 3</span>
                                <br><small class="text-muted">2 days remaining</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item deadline-alert p-3 mb-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>PROP-D1.1</strong> - Submit Stage 1 proposal
                                <br><small class="text-muted">Owner: pm</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-danger">Due: Sep 4</span>
                                <br><small class="text-muted">3 days remaining</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Work Package Status -->
{% if wbs_data and wbs_data.work_packages %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5><i class="fas fa-project-diagram"></i> Work Package Status</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for wp in wbs_data.work_packages %}
                    <div class="col-md-4 mb-3">
                        <div class="card border-left-primary">
                            <div class="card-body">
                                <h6 class="card-title">{{ wp.id }}: {{ wp.title }}</h6>
                                <p class="card-text">
                                    <strong>Leader:</strong> {{ wp.leader }}<br>
                                    <strong>Status:</strong> 
                                    {% if wp.id == 'WP1' %}
                                        <span class="badge bg-warning">Planning</span>
                                    {% elif wp.id == 'WP2' %}
                                        <span class="badge bg-info">Ready</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Pending</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- System Health -->
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5><i class="fas fa-heartbeat"></i> System Health</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <i class="fas fa-check-circle text-success"></i>
                        Authentication System: <strong>Active</strong>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check-circle text-success"></i>
                        Proposal Generator: <strong>Ready</strong>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check-circle text-success"></i>
                        WBS Monitoring: <strong>Active</strong>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-exclamation-triangle text-warning"></i>
                        OpenAI Integration: <strong>Needs API Key</strong>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5><i class="fas fa-info-circle"></i> Key Information</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <strong>Call ID:</strong> HORIZON-CL6-2025-02-FARM2FORK-01-two-stage
                    </li>
                    <li class="mb-2">
                        <strong>Submission:</strong> Two-stage process
                    </li>
                    <li class="mb-2">
                        <strong>Budget:</strong> ~â‚¬6M EU contribution
                    </li>
                    <li class="mb-2">
                        <strong>Innovation:</strong> Phosphinic acid derivatives
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

{% endblock %}
